<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classes & Programs - Luxor Heights Art Of Living Center</title>
    <meta name="description"
        content="Explore our Yoga, Meditation, and Happiness programs. Find timings, fees, and benefits for each class.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&family=Playfair+Display:wght@400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-766599420">
    </script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'AW-766599420');
    </script>
</head>

<body>

    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">Luxor Heights</div>
                <div class="mobile-menu-btn"><i class="fas fa-bars"></i></div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="classes.html" class="active" style="color: var(--primary-color);">Classes</a></li>
                    <li><a href="events.html">Events</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="contact.html" class="btn btn-primary" style="padding: 0.5rem 1rem;">Join Now</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div style="height: 80px;"></div>

    <section class="section">
        <div class="container">
            <div class="text-center mb-lg">
                <span style="color: var(--primary-color);">Wellness for Everyone</span>
                <h1>Our Classes & Programs</h1>
                <p>Designed to fit your lifestyle and needs.</p>
            </div>

            <div style="display: grid; gap: var(--spacing-md);">

                <!-- Loading State -->
                <div id="loading" class="text-center" style="grid-column: 1/-1; padding: 2rem;">
                    <i class="fas fa-spinner fa-spin fa-2x" style="color: var(--primary-color);"></i>
                    <p class="mt-sm">Loading programs...</p>
                </div>

                <!-- Programs Container -->
                <div id="programs-container" style="display: contents;">
                    <!-- Programs will be injected here -->
                </div>

            </div>
        </div>
    </section>

    <!-- Footer Script -->
    <script src="js/main.js"></script>
    <script>
        async function loadPrograms() {
            const container = document.getElementById('programs-container');
            const loading = document.getElementById('loading');

            try {
                // Try fetching from API first (if worker is set up), fallback to JSON file
                let data;
                try {
                    const response = await fetch('/api/programs');
                    if (response.ok) {
                        data = await response.json();
                    } else {
                        throw new Error('API not available');
                    }
                } catch (e) {
                    // Fallback to static JSON
                    const response = await fetch('data/programs.json');
                    data = await response.json();
                }

                loading.style.display = 'none';

                data.forEach(program => {
                    const card = document.createElement('div');
                    card.className = 'program-card';
                    card.style.cssText = 'display: flex; flex-direction: column; background: white; border-radius: var(--radius-md); overflow: hidden; box-shadow: var(--shadow-sm); border: 1px solid #eee; transition: var(--transition-normal);';

                    // Allow benefits to be optional
                    let benefitsHtml = '';
                    if (program.benefits && program.benefits.length > 0) {
                        benefitsHtml = `<ul style="margin-bottom: 1rem; color: var(--text-color);">
                            ${program.benefits.map(b => `<li><i class="fas fa-check" style="color: var(--success-color);"></i> ${b}</li>`).join('')}
                        </ul>`;
                    }

                    // Optional Tag
                    let tagHtml = '';
                    if (program.tag) {
                        tagHtml = `<span style="background: var(--accent-color); padding: 0.2rem 0.8rem; border-radius: var(--radius-full); font-size: 0.8rem; font-weight: 600;">${program.tag}</span>`;
                    }

                    card.innerHTML = `
                        <div style="flex: 1;">
                            <img src="${program.image}" alt="${program.title}" style="height: 100%; width: 100%; object-fit: cover; min-height: 250px;">
                        </div>
                        <div style="flex: 2; padding: var(--spacing-md);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                                <h2 style="font-size: 1.8rem; margin: 0;">${program.title}</h2>
                                ${tagHtml}
                            </div>
                            <p style="color: var(--text-light); margin-bottom: 1rem;">${program.description}</p>
                            ${benefitsHtml}
                            <div style="background: var(--bg-color); padding: 1rem; border-radius: var(--radius-sm); margin-bottom: 1rem;">
                                <p><strong>Timing:</strong> ${program.timing}</p>
                                <p><strong>Fee:</strong> ${program.fee}</p>
                            </div>
                            <a href="${program.link}" class="btn btn-primary">${program.buttonText || 'Register Now'}</a>
                        </div>
                    `;

                    container.appendChild(card);
                });

                // Re-apply responsive check
                handleResize();

            } catch (error) {
                console.error('Error loading programs:', error);
                loading.innerHTML = '<p class="text-center" style="color: var(--error-color);">Failed to load programs.</p>';
            }
        }

        function handleResize() {
            const cards = document.querySelectorAll('.program-card');
            cards.forEach(card => {
                if (window.innerWidth < 768) {
                    card.style.flexDirection = 'column';
                } else {
                    card.style.flexDirection = 'row';
                }
            });
        }

        window.addEventListener('resize', handleResize);
        document.addEventListener('DOMContentLoaded', loadPrograms);
    </script>
</body>

</html>